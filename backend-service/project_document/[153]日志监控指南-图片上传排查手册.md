# æ—¥å¿—ç›‘æ§æŒ‡å— - å›¾ç‰‡ä¸Šä¼ æ’æŸ¥æ‰‹å†Œ

**æ–‡æ¡£ç¼–å·**: 113  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-14  
**é€‚ç”¨ç‰ˆæœ¬**: v2.3.1+  
**ç”¨é€”**: å¸®åŠ©å¼€å‘è€…é€šè¿‡æ—¥å¿—å¿«é€Ÿå®šä½å›¾ç‰‡ä¸Šä¼ é—®é¢˜

---

## ğŸ“‹ ç›®å½•

1. [æ—¥å¿—ç³»ç»Ÿæ¦‚è¿°](#æ—¥å¿—ç³»ç»Ÿæ¦‚è¿°)
2. [å®æ—¶ç›‘æ§å‘½ä»¤](#å®æ—¶ç›‘æ§å‘½ä»¤)
3. [å®Œæ•´ä¸Šä¼ æµç¨‹æ—¥å¿—ç¤ºä¾‹](#å®Œæ•´ä¸Šä¼ æµç¨‹æ—¥å¿—ç¤ºä¾‹)
4. [å¸¸è§é—®é¢˜æ’æŸ¥](#å¸¸è§é—®é¢˜æ’æŸ¥)
5. [æ—¥å¿—çº§åˆ«è¯´æ˜](#æ—¥å¿—çº§åˆ«è¯´æ˜)
6. [æ€§èƒ½ç›‘æ§æŒ‡æ ‡](#æ€§èƒ½ç›‘æ§æŒ‡æ ‡)

---

## æ—¥å¿—ç³»ç»Ÿæ¦‚è¿°

### æ—¥å¿—æ–‡ä»¶ä½ç½®

```bash
/home/kun/projects/SharePix/backend-service/logs/auth-service.log
```

### æ—¥å¿—æ ‡ç­¾ç³»ç»Ÿ

æ‰€æœ‰å›¾ç‰‡ä¸Šä¼ ç›¸å…³æ—¥å¿—éƒ½ä½¿ç”¨æ ‡ç­¾å‰ç¼€ï¼Œæ–¹ä¾¿è¿‡æ»¤ï¼š

| æ ‡ç­¾ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `[CREATE POST]` | åˆ›å»ºå¸–å­ä¸»æµç¨‹ | `[CREATE POST] Request received` |
| `[SAVE FILE]` | æ–‡ä»¶ä¿å­˜å’ŒBase64å¤„ç† | `[SAVE FILE] Base64 detected` |
| `âœ“` | æˆåŠŸæ“ä½œ | `[CREATE POST] âœ“ Post created successfully` |
| `âœ—` | å¤±è´¥æ“ä½œ | `[SAVE FILE] âœ— Decode failed` |
| `âš ` | è­¦å‘Šä¿¡æ¯ | `[SAVE FILE] âš  Base64 detected` |
| `â†’` | è¯¦ç»†ä¿¡æ¯ | `[SAVE FILE]   â†’ Size: 10KB` |

---

## å®æ—¶ç›‘æ§å‘½ä»¤

### åŸºç¡€ç›‘æ§

```bash
# ç›‘æ§æ‰€æœ‰æ—¥å¿—
tail -f logs/auth-service.log

# åªçœ‹åˆ›å»ºå¸–å­ç›¸å…³
tail -f logs/auth-service.log | grep "CREATE POST"

# åªçœ‹æ–‡ä»¶ä¿å­˜ç›¸å…³
tail -f logs/auth-service.log | grep "SAVE FILE"

# åªçœ‹Base64ç›¸å…³æ“ä½œ
tail -f logs/auth-service.log | grep -i base64

# åªçœ‹é”™è¯¯å’Œè­¦å‘Š
tail -f logs/auth-service.log | grep -E "ERROR|WARNING|âœ—"

# åªçœ‹æˆåŠŸæ“ä½œ
tail -f logs/auth-service.log | grep "âœ“"
```

### é«˜çº§è¿‡æ»¤

```bash
# ç›‘æ§ç‰¹å®šç”¨æˆ·çš„ä¸Šä¼ ï¼ˆæ›¿æ¢UserIDï¼‰
tail -f logs/auth-service.log | grep "UserID: 123"

# ç›‘æ§Base64è§£ç æ€§èƒ½
tail -f logs/auth-service.log | grep "Decode time"

# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯ï¼ˆæœ€å50è¡Œï¼‰
tail -50 logs/auth-service.log | grep -E "ERROR|âœ—"

# å®æ—¶æ˜¾ç¤ºå¸¦é¢œè‰²çš„æ—¥å¿—ï¼ˆéœ€è¦å®‰è£…cczeï¼‰
tail -f logs/auth-service.log | ccze -A
```

### å¤šçª—å£ç›‘æ§

æ¨èä½¿ç”¨tmuxåˆ†å±ç›‘æ§ï¼š

```bash
# çª—å£1ï¼šæ‰€æœ‰æ—¥å¿—
tail -f logs/auth-service.log

# çª—å£2ï¼šåªçœ‹Base64ç›¸å…³
tail -f logs/auth-service.log | grep -i base64

# çª—å£3ï¼šåªçœ‹é”™è¯¯
tail -f logs/auth-service.log | grep -E "ERROR|âœ—"
```

---

## å®Œæ•´ä¸Šä¼ æµç¨‹æ—¥å¿—ç¤ºä¾‹

### åœºæ™¯1ï¼šäºŒè¿›åˆ¶ä¸Šä¼ ï¼ˆæ­£å¸¸æµç¨‹ï¼‰

```log
[INFO] === [CREATE POST] Request received ===
[INFO] [CREATE POST] User authenticated - UserID: 123
[INFO] [CREATE POST] Form data - Title: 'æµ‹è¯•å¸–å­', Tags: 2
[INFO] [CREATE POST] Received 3 image file(s)
[INFO] [CREATE POST] Processing image 1/3 - Filename: photo1.png, ContentType: image/png, Size: 102400 bytes
[INFO] [SAVE FILE] Starting to process file - Name: photo1.png, Type: image/png, OriginalSize: 102400 bytes
[INFO] [SAVE FILE] Binary data detected (not Base64)
[INFO] [SAVE FILE]   â†’ Processing as direct binary upload
[INFO] [SAVE FILE] Writing to: /tmp/knot_uploads/upload_1729012345678_1234.png
[INFO] [SAVE FILE] âœ“ File saved successfully!
[INFO] [SAVE FILE]   â†’ Path: /tmp/knot_uploads/upload_1729012345678_1234.png
[INFO] [SAVE FILE]   â†’ Final size: 102400 bytes
[INFO] [SAVE FILE]   â†’ Mode: Direct Binary
[INFO] [CREATE POST] Image 1 saved successfully
[INFO] [CREATE POST] Processing image 2/3 - Filename: photo2.jpg, ContentType: image/jpeg, Size: 153600 bytes
[INFO] [SAVE FILE] Starting to process file - Name: photo2.jpg, Type: image/jpeg, OriginalSize: 153600 bytes
[INFO] [SAVE FILE] Binary data detected (not Base64)
[INFO] [SAVE FILE]   â†’ Processing as direct binary upload
[INFO] [SAVE FILE] Writing to: /tmp/knot_uploads/upload_1729012345789_5678.jpg
[INFO] [SAVE FILE] âœ“ File saved successfully!
[INFO] [SAVE FILE]   â†’ Path: /tmp/knot_uploads/upload_1729012345789_5678.jpg
[INFO] [SAVE FILE]   â†’ Final size: 153600 bytes
[INFO] [SAVE FILE]   â†’ Mode: Direct Binary
[INFO] [CREATE POST] Image 2 saved successfully
[INFO] [CREATE POST] Processing image 3/3 - Filename: photo3.png, ContentType: image/png, Size: 98304 bytes
[INFO] [SAVE FILE] Starting to process file - Name: photo3.png, Type: image/png, OriginalSize: 98304 bytes
[INFO] [SAVE FILE] Binary data detected (not Base64)
[INFO] [SAVE FILE]   â†’ Processing as direct binary upload
[INFO] [SAVE FILE] Writing to: /tmp/knot_uploads/upload_1729012345890_9012.png
[INFO] [SAVE FILE] âœ“ File saved successfully!
[INFO] [SAVE FILE]   â†’ Path: /tmp/knot_uploads/upload_1729012345890_9012.png
[INFO] [SAVE FILE]   â†’ Final size: 98304 bytes
[INFO] [SAVE FILE]   â†’ Mode: Direct Binary
[INFO] [CREATE POST] Image 3 saved successfully
[INFO] [CREATE POST] All images validated successfully, total: 3
[INFO] [CREATE POST] Creating post in database...
[DEBUG] [CREATE POST] Temporary files cleaned up
[INFO] [CREATE POST] âœ“ Post created successfully - PostID: POST_2025Q4_abc123, UserID: 123, Images: 3
```

**å…³é”®æŒ‡æ ‡**ï¼š
- âœ… 3ä¸ªå›¾ç‰‡å…¨éƒ¨äºŒè¿›åˆ¶ä¸Šä¼ 
- âœ… æ— Base64è§£ç å¼€é”€
- âœ… æ€»è€—æ—¶çº¦200-300ms

---

### åœºæ™¯2ï¼šBase64ä¸Šä¼ ï¼ˆè‡ªåŠ¨è§£ç ï¼‰

```log
[INFO] === [CREATE POST] Request received ===
[INFO] [CREATE POST] User authenticated - UserID: 456
[INFO] [CREATE POST] Form data - Title: 'Base64æµ‹è¯•', Tags: 1
[INFO] [CREATE POST] Received 2 image file(s)
[INFO] [CREATE POST] Processing image 1/2 - Filename: image1.png, ContentType: image/png, Size: 136533 bytes
[INFO] [SAVE FILE] Starting to process file - Name: image1.png, Type: image/png, OriginalSize: 136533 bytes
[INFO] [SAVE FILE] âš  Base64 encoded data detected!
[INFO] [SAVE FILE]   â†’ Data format: Pure Base64
[INFO] [SAVE FILE]   â†’ Encoded size: 136533 bytes
[INFO] [SAVE FILE] âœ“ Base64 decode successful!
[INFO] [SAVE FILE]   â†’ Decoded size: 102400 bytes
[INFO] [SAVE FILE]   â†’ Size reduction: 25%
[INFO] [SAVE FILE]   â†’ Decode time: 2 ms
[INFO] [SAVE FILE]   â†’ Image format verified: PNG
[INFO] [SAVE FILE] Writing to: /tmp/knot_uploads/upload_1729012456789_2345.png
[INFO] [SAVE FILE] âœ“ File saved successfully!
[INFO] [SAVE FILE]   â†’ Path: /tmp/knot_uploads/upload_1729012456789_2345.png
[INFO] [SAVE FILE]   â†’ Final size: 102400 bytes
[INFO] [SAVE FILE]   â†’ Mode: Base64â†’Binary
[INFO] [CREATE POST] Image 1 saved successfully
[INFO] [CREATE POST] Processing image 2/2 - Filename: image2.jpg, ContentType: image/jpeg, Size: 204800 bytes
[INFO] [SAVE FILE] Starting to process file - Name: image2.jpg, Type: image/jpeg, OriginalSize: 204800 bytes
[INFO] [SAVE FILE] âš  Base64 encoded data detected!
[INFO] [SAVE FILE]   â†’ Data format: Data URI
[INFO] [SAVE FILE]   â†’ Encoded size: 204800 bytes
[INFO] [SAVE FILE] âœ“ Base64 decode successful!
[INFO] [SAVE FILE]   â†’ Decoded size: 153600 bytes
[INFO] [SAVE FILE]   â†’ Size reduction: 25%
[INFO] [SAVE FILE]   â†’ Decode time: 3 ms
[INFO] [SAVE FILE]   â†’ Image format verified: JPEG
[INFO] [SAVE FILE] Writing to: /tmp/knot_uploads/upload_1729012456890_6789.jpg
[INFO] [SAVE FILE] âœ“ File saved successfully!
[INFO] [SAVE FILE]   â†’ Path: /tmp/knot_uploads/upload_1729012456890_6789.jpg
[INFO] [SAVE FILE]   â†’ Final size: 153600 bytes
[INFO] [SAVE FILE]   â†’ Mode: Base64â†’Binary
[INFO] [CREATE POST] Image 2 saved successfully
[INFO] [CREATE POST] All images validated successfully, total: 2
[INFO] [CREATE POST] Creating post in database...
[DEBUG] [CREATE POST] Temporary files cleaned up
[INFO] [CREATE POST] âœ“ Post created successfully - PostID: POST_2025Q4_def456, UserID: 456, Images: 2
```

**å…³é”®æŒ‡æ ‡**ï¼š
- âš ï¸ æ£€æµ‹åˆ°Base64ç¼–ç 
- âœ… è‡ªåŠ¨è§£ç æˆåŠŸ
- âœ… å¤§å°å‡å°‘25%ï¼ˆBase64â†’Binaryï¼‰
- âš ï¸ è§£ç è€—æ—¶2-3msï¼ˆé¢å¤–å¼€é”€ï¼‰

---

### åœºæ™¯3ï¼šä¸Šä¼ å¤±è´¥ç¤ºä¾‹

#### 3.1 TokenéªŒè¯å¤±è´¥

```log
[INFO] === [CREATE POST] Request received ===
[WARNING] [CREATE POST] Invalid authentication token
```

**æ’æŸ¥æ–¹å‘**ï¼š
- æ£€æŸ¥å‰ç«¯æ˜¯å¦æ­£ç¡®è®¾ç½®Authorizationå¤´
- éªŒè¯tokenæ˜¯å¦è¿‡æœŸ
- ç¡®è®¤tokenæ ¼å¼æ˜¯å¦ä¸º `Bearer <token>`

---

#### 3.2 æ–‡ä»¶ç±»å‹é”™è¯¯

```log
[INFO] === [CREATE POST] Request received ===
[INFO] [CREATE POST] User authenticated - UserID: 789
[INFO] [CREATE POST] Form data - Title: 'é”™è¯¯æµ‹è¯•', Tags: 0
[INFO] [CREATE POST] Received 1 image file(s)
[INFO] [CREATE POST] Processing image 1/1 - Filename: document.pdf, ContentType: application/pdf, Size: 204800 bytes
[WARNING] [CREATE POST] Invalid content type: application/pdf
```

**æ’æŸ¥æ–¹å‘**ï¼š
- å‰ç«¯åº”è¯¥è¿‡æ»¤éå›¾ç‰‡æ–‡ä»¶
- åªå…è®¸ `image/*` ç±»å‹

---

#### 3.3 Base64è§£ç å¤±è´¥

```log
[INFO] === [CREATE POST] Request received ===
[INFO] [CREATE POST] User authenticated - UserID: 999
[INFO] [CREATE POST] Form data - Title: 'è§£ç å¤±è´¥æµ‹è¯•', Tags: 0
[INFO] [CREATE POST] Received 1 image file(s)
[INFO] [CREATE POST] Processing image 1/1 - Filename: bad.png, ContentType: image/png, Size: 50000 bytes
[INFO] [SAVE FILE] Starting to process file - Name: bad.png, Type: image/png, OriginalSize: 50000 bytes
[INFO] [SAVE FILE] âš  Base64 encoded data detected!
[INFO] [SAVE FILE]   â†’ Data format: Pure Base64
[INFO] [SAVE FILE]   â†’ Encoded size: 50000 bytes
[ERROR] [SAVE FILE] âœ— Base64 decode failed: Invalid Base64 character
[WARNING] [SAVE FILE]   â†’ Falling back to treating as binary data
[INFO] [SAVE FILE] Writing to: /tmp/knot_uploads/upload_1729012567890_1111.png
[INFO] [SAVE FILE] âœ“ File saved successfully!
[INFO] [SAVE FILE]   â†’ Path: /tmp/knot_uploads/upload_1729012567890_1111.png
[INFO] [SAVE FILE]   â†’ Final size: 50000 bytes
[INFO] [SAVE FILE]   â†’ Mode: Direct Binary
[ERROR] Image validation failed: Invalid format
```

**æ’æŸ¥æ–¹å‘**ï¼š
- å‰ç«¯Base64ç¼–ç å¯èƒ½ä¸æ­£ç¡®
- æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æˆªæ–­æˆ–æŸå
- å°è¯•ä½¿ç”¨äºŒè¿›åˆ¶ä¸Šä¼ ä»£æ›¿Base64

---

#### 3.4 æ–‡ä»¶å¤ªå°ï¼ˆè§£ç åï¼‰

```log
[INFO] [SAVE FILE] âš  Base64 encoded data detected!
[INFO] [SAVE FILE]   â†’ Data format: Pure Base64
[INFO] [SAVE FILE]   â†’ Encoded size: 100 bytes
[INFO] [SAVE FILE] âœ“ Base64 decode successful!
[INFO] [SAVE FILE]   â†’ Decoded size: 5 bytes
[ERROR] [SAVE FILE] âœ— Decoded data too small to be valid image
```

**æ’æŸ¥æ–¹å‘**ï¼š
- å‰ç«¯å¯èƒ½å‘é€äº†ç©ºæ•°æ®æˆ–æŸåçš„Base64
- æ£€æŸ¥å‰ç«¯æ–‡ä»¶è¯»å–é€»è¾‘

---

#### 3.5 æ•°æ®åº“æ“ä½œå¤±è´¥

```log
[INFO] [CREATE POST] All images validated successfully, total: 2
[INFO] [CREATE POST] Creating post in database...
[ERROR] [CREATE POST] âœ— Failed to create post - Reason: Database connection timeout
```

**æ’æŸ¥æ–¹å‘**ï¼š
- æ£€æŸ¥æ•°æ®åº“è¿æ¥çŠ¶æ€
- æŸ¥çœ‹æ•°æ®åº“è¿æ¥æ± æ˜¯å¦è€—å°½
- æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦æ­£å¸¸

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šå‰ç«¯æŠ¥400é”™è¯¯

**ç›‘æ§å‘½ä»¤**ï¼š
```bash
tail -f logs/auth-service.log | grep -E "\[CREATE POST\]|WARNING|ERROR"
```

**å¯èƒ½åŸå› **ï¼š

| æ—¥å¿—å…³é”®è¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|-----------|------|---------|
| `Title is empty` | æ ‡é¢˜ä¸ºç©º | å‰ç«¯å¿…é¡»æä¾›titleå­—æ®µ |
| `Invalid content type` | æ–‡ä»¶ç±»å‹ä¸æ˜¯å›¾ç‰‡ | å‰ç«¯è¿‡æ»¤éå›¾ç‰‡æ–‡ä»¶ |
| `File size exceeds limit` | æ–‡ä»¶è¶…è¿‡5MB | å‹ç¼©å›¾ç‰‡æˆ–æç¤ºç”¨æˆ· |
| `Invalid image count` | å›¾ç‰‡æ•°é‡ä¸åœ¨1-9ä¹‹é—´ | å‰ç«¯é™åˆ¶ä¸Šä¼ æ•°é‡ |
| `No image files found` | æœªæ‰¾åˆ°imageFileså­—æ®µ | æ£€æŸ¥FormDataå­—æ®µå |

---

### é—®é¢˜2ï¼šå‰ç«¯æŠ¥401é”™è¯¯

**ç›‘æ§å‘½ä»¤**ï¼š
```bash
tail -f logs/auth-service.log | grep "authentication"
```

**å¯èƒ½åŸå› **ï¼š

| æ—¥å¿—å…³é”®è¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|-----------|------|---------|
| `No authentication token` | æœªæä¾›Token | æ£€æŸ¥Authorizationå¤´ |
| `Invalid authentication token` | Tokenæ— æ•ˆæˆ–è¿‡æœŸ | åˆ·æ–°Tokenåé‡è¯• |

---

### é—®é¢˜3ï¼šBase64ä¸Šä¼ åå›¾ç‰‡æŸå

**ç›‘æ§å‘½ä»¤**ï¼š
```bash
tail -f logs/auth-service.log | grep -E "Base64|Image format"
```

**æ’æŸ¥æ­¥éª¤**ï¼š

1. æŸ¥çœ‹æ˜¯å¦æ£€æµ‹åˆ°Base64ï¼š
   ```log
   [INFO] [SAVE FILE] âš  Base64 encoded data detected!
   ```

2. æŸ¥çœ‹è§£ç æ˜¯å¦æˆåŠŸï¼š
   ```log
   [INFO] [SAVE FILE] âœ“ Base64 decode successful!
   [INFO] [SAVE FILE]   â†’ Decoded size: 102400 bytes
   ```

3. æŸ¥çœ‹å›¾ç‰‡æ ¼å¼éªŒè¯ï¼š
   ```log
   [INFO] [SAVE FILE]   â†’ Image format verified: PNG
   ```

å¦‚æœæ²¡æœ‰çœ‹åˆ°"Image format verified"ï¼Œè¯´æ˜è§£ç åçš„æ•°æ®ä¸æ˜¯æœ‰æ•ˆå›¾ç‰‡ã€‚

---

### é—®é¢˜4ï¼šæ€§èƒ½ç¼“æ…¢

**ç›‘æ§å‘½ä»¤**ï¼š
```bash
tail -f logs/auth-service.log | grep "Decode time"
```

**æ€§èƒ½åŸºå‡†**ï¼š

| æ–‡ä»¶å¤§å° | Base64è§£ç æ—¶é—´ | æ­£å¸¸èŒƒå›´ |
|---------|---------------|---------|
| 100KB | < 1ms | âœ“ æ­£å¸¸ |
| 1MB | 1-5ms | âœ“ æ­£å¸¸ |
| 5MB | 5-20ms | âš ï¸ å¯æ¥å— |
| >5MB | >20ms | âœ— å»ºè®®ä¼˜åŒ– |

å¦‚æœè§£ç æ—¶é—´è¶…å‡ºæ­£å¸¸èŒƒå›´ï¼Œå»ºè®®ï¼š
- å‰ç«¯æ”¹ç”¨äºŒè¿›åˆ¶ä¸Šä¼ 
- å‰ç«¯å…ˆå‹ç¼©å›¾ç‰‡
- æ£€æŸ¥æœåŠ¡å™¨CPUè´Ÿè½½

---

## æ—¥å¿—çº§åˆ«è¯´æ˜

### INFO - ä¿¡æ¯çº§åˆ«

**ç”¨é€”**ï¼šæ­£å¸¸æ“ä½œæµç¨‹

**ç¤ºä¾‹**ï¼š
```log
[INFO] === [CREATE POST] Request received ===
[INFO] [SAVE FILE] Binary data detected (not Base64)
[INFO] [CREATE POST] âœ“ Post created successfully
```

**ä½•æ—¶å…³æ³¨**ï¼šæ—¥å¸¸ç›‘æ§ï¼Œäº†è§£ç³»ç»Ÿè¿è¡ŒçŠ¶æ€

---

### WARNING - è­¦å‘Šçº§åˆ«

**ç”¨é€”**ï¼šæ½œåœ¨é—®é¢˜æˆ–å¼‚å¸¸æƒ…å†µ

**ç¤ºä¾‹**ï¼š
```log
[WARNING] [CREATE POST] Invalid content type: application/pdf
[WARNING] [SAVE FILE]   â†’ Falling back to treating as binary data
[WARNING] [CREATE POST] No image files found in request
```

**ä½•æ—¶å…³æ³¨**ï¼šæ’æŸ¥é—®é¢˜æ—¶ä¼˜å…ˆæŸ¥çœ‹

---

### ERROR - é”™è¯¯çº§åˆ«

**ç”¨é€”**ï¼šæ“ä½œå¤±è´¥

**ç¤ºä¾‹**ï¼š
```log
[ERROR] [SAVE FILE] âœ— Base64 decode failed: Invalid character
[ERROR] [CREATE POST] âœ— Failed to create post
[ERROR] [SAVE FILE] âœ— Failed to open file for writing
```

**ä½•æ—¶å…³æ³¨**ï¼šç«‹å³å¤„ç†ï¼Œè¡¨ç¤ºåŠŸèƒ½ä¸å¯ç”¨

---

### DEBUG - è°ƒè¯•çº§åˆ«

**ç”¨é€”**ï¼šè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯

**ç¤ºä¾‹**ï¼š
```log
[DEBUG] [CREATE POST] Temporary files cleaned up
```

**ä½•æ—¶å…³æ³¨**ï¼šå¼€å‘é˜¶æ®µï¼Œç”Ÿäº§ç¯å¢ƒå¯å…³é—­

---

## æ€§èƒ½ç›‘æ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡ç›‘æ§

#### 1. Base64è§£ç ç‡

**æŸ¥çœ‹å‘½ä»¤**ï¼š
```bash
# ç»Ÿè®¡æœ€è¿‘100æ¬¡ä¸Šä¼ ä¸­Base64çš„æ¯”ä¾‹
tail -100 logs/auth-service.log | grep "SAVE FILE" | grep -c "Base64 detected"
```

**å¥åº·æ ‡å‡†**ï¼š
- 0%ï¼šå®Œç¾ï¼Œå…¨éƒ¨äºŒè¿›åˆ¶ä¸Šä¼ 
- <50%ï¼šå¯æ¥å—ï¼Œéƒ¨åˆ†Base64
- >50%ï¼šå»ºè®®ä¼˜åŒ–ï¼Œå‰ç«¯æ”¹ç”¨äºŒè¿›åˆ¶

---

#### 2. å¹³å‡è§£ç æ—¶é—´

**æŸ¥çœ‹å‘½ä»¤**ï¼š
```bash
# æå–è§£ç æ—¶é—´
tail -100 logs/auth-service.log | grep "Decode time" | sed 's/.*Decode time: \([0-9]*\) ms.*/\1/'
```

**å¥åº·æ ‡å‡†**ï¼š
- <5msï¼šä¼˜ç§€
- 5-10msï¼šè‰¯å¥½
- >10msï¼šéœ€è¦ä¼˜åŒ–

---

#### 3. é”™è¯¯ç‡

**æŸ¥çœ‹å‘½ä»¤**ï¼š
```bash
# ç»Ÿè®¡æœ€è¿‘100ä¸ªè¯·æ±‚çš„é”™è¯¯æ•°
tail -100 logs/auth-service.log | grep "CREATE POST" | grep -c "âœ—"
```

**å¥åº·æ ‡å‡†**ï¼š
- 0%ï¼šå®Œç¾
- <5%ï¼šå¯æ¥å—
- >5%ï¼šéœ€è¦æ’æŸ¥

---

#### 4. ä¸Šä¼ æˆåŠŸç‡

**æŸ¥çœ‹å‘½ä»¤**ï¼š
```bash
# æˆåŠŸæ¬¡æ•°
SUCCESS=$(tail -100 logs/auth-service.log | grep "CREATE POST" | grep -c "âœ“")

# å¤±è´¥æ¬¡æ•°
FAIL=$(tail -100 logs/auth-service.log | grep "CREATE POST" | grep -c "âœ—")

# è®¡ç®—æˆåŠŸç‡
echo "scale=2; $SUCCESS * 100 / ($SUCCESS + $FAIL)" | bc
```

**å¥åº·æ ‡å‡†**ï¼š
- >95%ï¼šä¼˜ç§€
- 90-95%ï¼šè‰¯å¥½
- <90%ï¼šéœ€è¦ä¼˜åŒ–

---

## æ—¥å¿—åˆ†æè„šæœ¬

### è‡ªåŠ¨ç»Ÿè®¡è„šæœ¬

åˆ›å»º `analyze_upload_logs.sh`ï¼š

```bash
#!/bin/bash

LOG_FILE="logs/auth-service.log"
LINES=1000

echo "=== å›¾ç‰‡ä¸Šä¼ æ—¥å¿—åˆ†æï¼ˆæœ€è¿‘${LINES}è¡Œï¼‰==="
echo ""

# æ€»ä¸Šä¼ æ¬¡æ•°
TOTAL=$(tail -$LINES $LOG_FILE | grep "CREATE POST.*Request received" | wc -l)
echo "æ€»ä¸Šä¼ æ¬¡æ•°: $TOTAL"

# æˆåŠŸæ¬¡æ•°
SUCCESS=$(tail -$LINES $LOG_FILE | grep "CREATE POST.*âœ“.*successfully" | wc -l)
echo "æˆåŠŸæ¬¡æ•°: $SUCCESS"

# å¤±è´¥æ¬¡æ•°
FAIL=$(tail -$LINES $LOG_FILE | grep "CREATE POST.*âœ—" | wc -l)
echo "å¤±è´¥æ¬¡æ•°: $FAIL"

# æˆåŠŸç‡
if [ $TOTAL -gt 0 ]; then
    SUCCESS_RATE=$(echo "scale=2; $SUCCESS * 100 / $TOTAL" | bc)
    echo "æˆåŠŸç‡: ${SUCCESS_RATE}%"
fi

echo ""
echo "=== Base64ä½¿ç”¨ç»Ÿè®¡ ==="

# Base64æ£€æµ‹æ¬¡æ•°
BASE64=$(tail -$LINES $LOG_FILE | grep "Base64 encoded data detected" | wc -l)
echo "Base64ä¸Šä¼ æ¬¡æ•°: $BASE64"

# äºŒè¿›åˆ¶ä¸Šä¼ æ¬¡æ•°
BINARY=$(tail -$LINES $LOG_FILE | grep "Binary data detected" | wc -l)
echo "äºŒè¿›åˆ¶ä¸Šä¼ æ¬¡æ•°: $BINARY"

# Base64å æ¯”
if [ $(($BASE64 + $BINARY)) -gt 0 ]; then
    BASE64_RATE=$(echo "scale=2; $BASE64 * 100 / ($BASE64 + $BINARY)" | bc)
    echo "Base64å æ¯”: ${BASE64_RATE}%"
fi

echo ""
echo "=== é”™è¯¯ç±»å‹ç»Ÿè®¡ ==="

# Tokené”™è¯¯
TOKEN_ERR=$(tail -$LINES $LOG_FILE | grep -c "Invalid authentication token")
echo "TokenéªŒè¯å¤±è´¥: $TOKEN_ERR"

# æ–‡ä»¶ç±»å‹é”™è¯¯
TYPE_ERR=$(tail -$LINES $LOG_FILE | grep -c "Invalid content type")
echo "æ–‡ä»¶ç±»å‹é”™è¯¯: $TYPE_ERR"

# æ–‡ä»¶å¤§å°é”™è¯¯
SIZE_ERR=$(tail -$LINES $LOG_FILE | grep -c "File size exceeds limit")
echo "æ–‡ä»¶è¿‡å¤§é”™è¯¯: $SIZE_ERR"

# Base64è§£ç é”™è¯¯
DECODE_ERR=$(tail -$LINES $LOG_FILE | grep -c "Base64 decode failed")
echo "Base64è§£ç å¤±è´¥: $DECODE_ERR"

echo ""
echo "åˆ†æå®Œæˆï¼"
```

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
chmod +x analyze_upload_logs.sh
./analyze_upload_logs.sh
```

---

## æ€»ç»“

### æ—¥å¸¸ç›‘æ§å»ºè®®

1. **å¼€å‘ç¯å¢ƒ**ï¼š
   ```bash
   tail -f logs/auth-service.log
   ```

2. **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   ```bash
   tail -f logs/auth-service.log | grep -E "WARNING|ERROR|âœ—"
   ```

3. **æ€§èƒ½è°ƒä¼˜**ï¼š
   ```bash
   tail -f logs/auth-service.log | grep -E "Base64|Decode time"
   ```

### å¿«é€Ÿæ’æŸ¥æ¸…å•

é‡åˆ°é—®é¢˜æ—¶æŒ‰é¡ºåºæ£€æŸ¥ï¼š

1. âœ“ æŸ¥çœ‹æ˜¯å¦æœ‰ERRORæ—¥å¿—
2. âœ“ æ£€æŸ¥TokenéªŒè¯æ˜¯å¦é€šè¿‡
3. âœ“ ç¡®è®¤æ–‡ä»¶ç±»å‹å’Œå¤§å°æ˜¯å¦åˆæ³•
4. âœ“ æŸ¥çœ‹Base64æ£€æµ‹å’Œè§£ç ç»“æœ
5. âœ“ éªŒè¯å›¾ç‰‡æ ¼å¼æ˜¯å¦æ­£ç¡®
6. âœ“ æ£€æŸ¥æ•°æ®åº“æ“ä½œæ˜¯å¦æˆåŠŸ

---

**ç›¸å…³æ–‡æ¡£**ï¼š
- [112]Base64å›¾ç‰‡ä¸Šä¼ é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ.md
- [000]APIæ–‡æ¡£.md - åˆ›å»ºå¸–å­æ¥å£è¯´æ˜

---

**ä½œè€…**: Knot Team  
**ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-10-14

