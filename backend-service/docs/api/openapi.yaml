openapi: 3.0.3
info:
  title: Knot - Image Sharing Service API
  description: |
    Knotå›¾ç‰‡åˆ†äº«ç³»ç»ŸAPIæ–‡æ¡£

    ## åŠŸèƒ½ç‰¹æ€§
    - ç”¨æˆ·è®¤è¯ä¸æˆæƒï¼ˆJWTï¼‰
    - å¤šå›¾ç‰‡å¸–å­å‘å¸ƒï¼ˆ1-9å¼ å›¾ç‰‡ï¼‰
    - å›¾ç‰‡ä¸Šä¼ ä¸ç®¡ç†
    - æ ‡ç­¾ç³»ç»Ÿ
    - Feedæµæ¨è
    - ç‚¹èµä¸æ”¶è—åŠŸèƒ½ï¼ˆv2.2.0ï¼‰
    - åˆ†äº«ç³»ç»Ÿä¸çŸ­é“¾æ¥ï¼ˆv2.3.0ï¼‰
    - **å›¾ç‰‡URLè‡ªåŠ¨å‰ç¼€ï¼ˆv2.4.0ï¼‰**

    ## ğŸ”” é‡è¦è¯´æ˜ï¼šå›¾ç‰‡URLè‡ªåŠ¨å‰ç¼€ï¼ˆv2.4.0æ–°å¢ï¼‰

    **æ‰€æœ‰è¿”å›çš„å›¾ç‰‡è·¯å¾„å·²è‡ªåŠ¨æ·»åŠ æœåŠ¡å™¨URLå‰ç¼€**ï¼Œå®¢æˆ·ç«¯å¯ç›´æ¥ä½¿ç”¨è¿”å›çš„å®Œæ•´URLè®¿é—®å›¾ç‰‡ã€‚

    **å½±å“å­—æ®µ**ï¼š
    - `file_url` - åŸå›¾URL
    - `thumbnail_url` - ç¼©ç•¥å›¾URL  
    - `cover_image_url` - å°é¢å›¾URL
    - `avatar_url` - ç”¨æˆ·å¤´åƒURL

    **è¿”å›æ ¼å¼ç¤ºä¾‹**ï¼š
    ```json
    {
      "file_url": "http://8.138.115.164:8080/uploads/images/IMG_2025Q4_xxx.jpg",
      "thumbnail_url": "http://8.138.115.164:8080/uploads/thumbnails/IMG_2025Q4_xxx_thumb.jpg"
    }
    ```

    **é…ç½®è¯´æ˜**ï¼š
    - ç”Ÿäº§ç¯å¢ƒï¼šè‡ªåŠ¨ä½¿ç”¨ `http://8.138.115.164:8080` ä½œä¸ºå‰ç¼€
    - å¼€å‘ç¯å¢ƒï¼šå¯åœ¨ `config.json` ä¸­é…ç½® `server.base_url` è‡ªå®šä¹‰å‰ç¼€
    - ç›¸å¯¹è·¯å¾„æ¨¡å¼ï¼šè®¾ç½® `server.base_url: ""` è¿”å›ç›¸å¯¹è·¯å¾„ï¼ˆç”¨äºæœ¬åœ°å¼€å‘ï¼‰

    ## å®‰å…¨è¯´æ˜
    - å¯†ç ä½¿ç”¨PBKDF2-HMAC-SHA256åŠ å¯†ï¼ˆ100,000æ¬¡è¿­ä»£ï¼‰
    - JWTä»¤ç‰Œä½¿ç”¨HS256ç­¾åç®—æ³•
    - æ‰€æœ‰æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥é˜²æ­¢SQLæ³¨å…¥

    ## ç‰ˆæœ¬æ›´æ–°
    - v2.4.0: å›¾ç‰‡URLè‡ªåŠ¨å‰ç¼€åŠŸèƒ½ï¼Œå®Œå–„APIæ–‡æ¡£
    - v2.3.0: æ–°å¢åˆ†äº«ç³»ç»Ÿï¼ˆçŸ­é“¾æ¥ã€Deep Linkï¼‰
    - v2.2.0: æ–°å¢ç‚¹èµå’Œæ”¶è—åŠŸèƒ½
    - v2.1.0: æ–°å¢ç”¨æˆ·ä¿¡æ¯ç®¡ç†åŠŸèƒ½
    - v2.0.0: æ–°å¢å¤šå›¾ç‰‡å¸–å­ç³»ç»Ÿ
    - v1.2.0: åŸºç¡€å›¾ç‰‡ç®¡ç†åŠŸèƒ½
  version: 2.4.0
  contact:
    name: Knot Team
    email: support@knot.example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080/api/v1
    description: æœ¬åœ°å¼€å‘æœåŠ¡å™¨
  - url: http://8.138.115.164:8080/api/v1
    description: äº‘æœåŠ¡å™¨æµ‹è¯•ç¯å¢ƒ

tags:
  - name: è®¤è¯
    description: ç”¨æˆ·è®¤è¯ç›¸å…³æ¥å£
  - name: ç”¨æˆ·ç®¡ç†
    description: ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢å’Œä¿®æ”¹ï¼ˆv2.1æ–°å¢ï¼‰
  - name: å¸–å­ç®¡ç†
    description: å¤šå›¾ç‰‡å¸–å­çš„åˆ›å»ºã€æŸ¥è¯¢ã€ç¼–è¾‘ã€åˆ é™¤ï¼ˆv2.0æ–°å¢ï¼‰
  - name: ç‚¹èµ
    description: å¸–å­ç‚¹èµåŠŸèƒ½ï¼ˆv2.2æ–°å¢ï¼‰
  - name: æ”¶è—
    description: å¸–å­æ”¶è—åŠŸèƒ½ï¼ˆv2.2æ–°å¢ï¼‰
  - name: åˆ†äº«
    description: å¸–å­åˆ†äº«ä¸çŸ­é“¾æ¥ï¼ˆv2.3æ–°å¢ï¼‰
  - name: å›¾ç‰‡ç®¡ç†
    description: å›¾ç‰‡ä¸Šä¼ ã€æŸ¥è¯¢ã€ç¼–è¾‘ã€åˆ é™¤
  - name: ç³»ç»Ÿ
    description: ç³»ç»Ÿå¥åº·æ£€æŸ¥å’Œç›‘æ§

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWTè®¿é—®ä»¤ç‰Œ

  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          description: ç‰©ç†ID
          example: 1
        user_id:
          type: string
          description: é€»è¾‘ID
          example: "USR_2025Q1_A1B2C3"
        username:
          type: string
          description: ç”¨æˆ·å
          example: "zhangsan"
        real_name:
          type: string
          description: çœŸå®å§“å
          example: "å¼ ä¸‰"
        phone:
          type: string
          description: æ‰‹æœºå·
          example: "13800138000"
        email:
          type: string
          description: é‚®ç®±
          example: "zhangsan@example.com"
        role:
          type: string
          enum: [USER, ADMIN]
          description: ç”¨æˆ·è§’è‰²
          example: "USER"
        status:
          type: string
          enum: [active, inactive, banned]
          description: è´¦æˆ·çŠ¶æ€
          example: "active"
        avatar_url:
          type: string
          description: å¤´åƒURLï¼ˆv2.4.0èµ·è‡ªåŠ¨æ·»åŠ æœåŠ¡å™¨å‰ç¼€ï¼‰
          example: "http://8.138.115.164:8080/uploads/avatars/user123.jpg"
        device_count:
          type: integer
          description: è®¾å¤‡æ•°é‡
          example: 0
        create_time:
          type: integer
          format: int64
          description: åˆ›å»ºæ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1704067200
        update_time:
          type: integer
          format: int64
          description: æ›´æ–°æ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1704067200

    Image:
      type: object
      properties:
        id:
          type: integer
          description: ç‰©ç†ID
          example: 1
        image_id:
          type: string
          description: ä¸šåŠ¡é€»è¾‘ID
          example: "IMG_2025Q4_123456"
        user_id:
          type: integer
          description: ç”¨æˆ·ID
          example: 1
        title:
          type: string
          description: å›¾ç‰‡æ ‡é¢˜
          example: "ç¾ä¸½çš„é£æ™¯"
        description:
          type: string
          description: å›¾ç‰‡æè¿°
          example: "ä»Šå¤©æ‹æ‘„çš„æ—¥è½"
        file_url:
          type: string
          description: å›¾ç‰‡æ–‡ä»¶URLï¼ˆv2.4.0èµ·è‡ªåŠ¨æ·»åŠ æœåŠ¡å™¨å‰ç¼€ï¼‰
          example: "http://8.138.115.164:8080/uploads/images/IMG_2025Q4_abc123.jpg"
        thumbnail_url:
          type: string
          description: ç¼©ç•¥å›¾URLï¼ˆv2.4.0èµ·è‡ªåŠ¨æ·»åŠ æœåŠ¡å™¨å‰ç¼€ï¼‰
          example: "http://8.138.115.164:8080/uploads/thumbnails/IMG_2025Q4_abc123_thumb.jpg"
        file_size:
          type: integer
          description: æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
          example: 1024000
        width:
          type: integer
          description: å›¾ç‰‡å®½åº¦
          example: 1920
        height:
          type: integer
          description: å›¾ç‰‡é«˜åº¦
          example: 1080
        mime_type:
          type: string
          description: MIMEç±»å‹
          example: "image/jpeg"
        like_count:
          type: integer
          description: ç‚¹èµæ•°
          example: 10
        favorite_count:
          type: integer
          description: æ”¶è—æ•°
          example: 5
        view_count:
          type: integer
          description: æµè§ˆæ•°
          example: 100
        status:
          type: string
          enum: [PENDING, APPROVED, REJECTED]
          description: å®¡æ ¸çŠ¶æ€
          example: "APPROVED"
        create_time:
          type: integer
          format: int64
          description: åˆ›å»ºæ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1759844400
        update_time:
          type: integer
          format: int64
          description: æ›´æ–°æ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1759844400

    Post:
      type: object
      properties:
        id:
          type: integer
          description: ç‰©ç†ID
          example: 1
        post_id:
          type: string
          description: ä¸šåŠ¡é€»è¾‘ID
          example: "POST_2025Q4_123456"
        user_id:
          type: integer
          description: ç”¨æˆ·ID
          example: 1
        title:
          type: string
          description: å¸–å­æ ‡é¢˜
          example: "ç¾å¥½çš„ä¸€å¤©"
        description:
          type: string
          description: å¸–å­æè¿°/é…æ–‡
          example: "ä»Šå¤©å¤©æ°”çœŸå¥½ï¼"
        image_count:
          type: integer
          description: å›¾ç‰‡æ•°é‡
          example: 3
        like_count:
          type: integer
          description: ç‚¹èµæ•°
          example: 10
        favorite_count:
          type: integer
          description: æ”¶è—æ•°
          example: 5
        view_count:
          type: integer
          description: æµè§ˆæ•°
          example: 100
        share_count:
          type: integer
          description: åˆ†äº«æ•°
          example: 2
        comment_count:
          type: integer
          description: è¯„è®ºæ•°
          example: 8
        status:
          type: string
          enum: [PENDING, APPROVED, REJECTED]
          description: å®¡æ ¸çŠ¶æ€
          example: "APPROVED"
        create_time:
          type: integer
          format: int64
          description: åˆ›å»ºæ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1759844400
        update_time:
          type: integer
          format: int64
          description: æ›´æ–°æ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1759844400
        images:
          type: array
          description: å¸–å­åŒ…å«çš„å›¾ç‰‡åˆ—è¡¨
          items:
            $ref: '#/components/schemas/Image'
        tags:
          type: array
          description: å¸–å­æ ‡ç­¾
          items:
            type: string
          example: ["é£æ™¯", "æ—…è¡Œ"]

    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "æ“ä½œæˆåŠŸ"
        data:
          type: object
        timestamp:
          type: integer
          format: int64
          example: 1759844400

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: "é”™è¯¯æè¿°"
        data:
          type: object
          nullable: true
          example: null
        timestamp:
          type: integer
          format: int64
          example: 1759844400

    LikeStatusResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                post_id:
                  type: string
                  description: å¸–å­ID
                  example: "POST_2025Q4_ABC123"
                has_liked:
                  type: boolean
                  description: æ˜¯å¦å·²ç‚¹èµ
                  example: true
                like_count:
                  type: integer
                  description: ç‚¹èµæ€»æ•°
                  example: 10

    FavoriteStatusResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                post_id:
                  type: string
                  description: å¸–å­ID
                  example: "POST_2025Q4_ABC123"
                has_favorited:
                  type: boolean
                  description: æ˜¯å¦å·²æ”¶è—
                  example: true
                favorite_count:
                  type: integer
                  description: æ”¶è—æ€»æ•°
                  example: 5

    FavoriteListResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                posts:
                  type: array
                  description: æ”¶è—çš„å¸–å­åˆ—è¡¨
                  items:
                    $ref: '#/components/schemas/Post'
                total:
                  type: integer
                  description: æ€»æ”¶è—æ•°
                  example: 15
                page:
                  type: integer
                  description: å½“å‰é¡µç 
                  example: 1
                page_size:
                  type: integer
                  description: æ¯é¡µæ•°é‡
                  example: 20
                total_pages:
                  type: integer
                  description: æ€»é¡µæ•°
                  example: 1

    ShareLink:
      type: object
      properties:
        short_code:
          type: string
          description: çŸ­é“¾æ¥ä»£ç ï¼ˆ8ä½Base62ç¼–ç ï¼‰
          example: "kHr7ZS9a"
        short_url:
          type: string
          description: å®Œæ•´çŸ­é“¾æ¥URL
          example: "http://8.138.115.164:8080/s/kHr7ZS9a"
        post_id:
          type: string
          description: å¸–å­ID
          example: "POST_2025Q4_ABC123"
        create_time:
          type: integer
          format: int64
          description: åˆ›å»ºæ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1728360600
        expire_time:
          type: integer
          format: int64
          nullable: true
          description: è¿‡æœŸæ—¶é—´ï¼ˆnullè¡¨ç¤ºæ°¸ä¹…æœ‰æ•ˆï¼‰
          example: null

    ShareLinkResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/ShareLink'

    SharePostResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                post:
                  $ref: '#/components/schemas/Post'
                share_info:
                  type: object
                  properties:
                    short_code:
                      type: string
                      example: "kHr7ZS9a"
                    create_time:
                      type: integer
                      format: int64
                      example: 1728360600

    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          description: ç”¨æˆ·å/æ‰‹æœºå·/é‚®ç®±
          example: "zhangsan"
        password:
          type: string
          format: password
          description: å¯†ç 
          example: "password123"

    LoginResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                access_token:
                  type: string
                  description: è®¿é—®ä»¤ç‰Œï¼ˆæœ‰æ•ˆæœŸ1å°æ—¶ï¼‰
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                refresh_token:
                  type: string
                  description: åˆ·æ–°ä»¤ç‰Œï¼ˆæœ‰æ•ˆæœŸ24å°æ—¶ï¼‰
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                user:
                  $ref: '#/components/schemas/User'

    RegisterRequest:
      type: object
      required:
        - username
        - password
        - real_name
        - phone
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
          pattern: '^[a-zA-Z0-9_]+$'
          description: ç”¨æˆ·åï¼ˆ3-50å­—ç¬¦ï¼Œå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰
          example: "zhangsan"
        password:
          type: string
          format: password
          minLength: 6
          maxLength: 100
          description: å¯†ç ï¼ˆ6-100å­—ç¬¦ï¼‰
          example: "password123"
        real_name:
          type: string
          maxLength: 50
          description: çœŸå®å§“å
          example: "å¼ ä¸‰"
        phone:
          type: string
          pattern: '^1[3-9]\d{9}$'
          description: æ‰‹æœºå·ï¼ˆ11ä½ä¸­å›½æ‰‹æœºå·ï¼‰
          example: "13800138000"
        email:
          type: string
          format: email
          description: é‚®ç®±ï¼ˆå¯é€‰ï¼‰
          example: "zhangsan@example.com"
        role:
          type: string
          enum: [USER, ADMIN]
          default: USER
          description: ç”¨æˆ·è§’è‰²
          example: "USER"

    UserProfileUpdateRequest:
      type: object
      properties:
        real_name:
          type: string
          maxLength: 50
          description: çœŸå®å§“å
          example: "å¼ ä¸‰"
        phone:
          type: string
          pattern: '^1[3-9]\d{9}$'
          description: æ‰‹æœºå·ï¼ˆ11ä½ä¸­å›½æ‰‹æœºå·ï¼‰
          example: "13800138000"
        email:
          type: string
          format: email
          description: é‚®ç®±
          example: "zhangsan@example.com"
        bio:
          type: string
          maxLength: 500
          description: ä¸ªäººç®€ä»‹
          example: "çƒ­çˆ±æ‘„å½±å’Œæ—…è¡Œ"
        avatar_url:
          type: string
          maxLength: 500
          description: å¤´åƒURLï¼ˆv2.4.0èµ·è‡ªåŠ¨æ·»åŠ æœåŠ¡å™¨å‰ç¼€ï¼‰
          example: "https://example.com/avatars/user123.jpg"
        location:
          type: string
          maxLength: 100
          description: æ‰€åœ¨åœ°
          example: "åŒ—äº¬å¸‚æœé˜³åŒº"
        website:
          type: string
          maxLength: 200
          description: ä¸ªäººç½‘ç«™
          example: "https://zhangsan.com"

    PublicUserProfile:
      type: object
      properties:
        user_id:
          type: integer
          description: ç”¨æˆ·ID
          example: 1
        username:
          type: string
          description: ç”¨æˆ·å
          example: "zhangsan"
        real_name:
          type: string
          description: çœŸå®å§“å
          example: "å¼ ä¸‰"
        bio:
          type: string
          description: ä¸ªäººç®€ä»‹
          example: "çƒ­çˆ±æ‘„å½±å’Œæ—…è¡Œ"
        avatar_url:
          type: string
          description: å¤´åƒURLï¼ˆv2.4.0èµ·è‡ªåŠ¨æ·»åŠ æœåŠ¡å™¨å‰ç¼€ï¼‰
          example: "http://8.138.115.164:8080/uploads/avatars/user123.jpg"
        location:
          type: string
          description: æ‰€åœ¨åœ°
          example: "åŒ—äº¬å¸‚æœé˜³åŒº"
        website:
          type: string
          description: ä¸ªäººç½‘ç«™
          example: "https://zhangsan.com"
        follower_count:
          type: integer
          description: ç²‰ä¸æ•°
          example: 1250
        following_count:
          type: integer
          description: å…³æ³¨æ•°
          example: 350
        post_count:
          type: integer
          description: å¸–å­æ•°
          example: 89
        total_likes:
          type: integer
          description: è·èµæ€»æ•°
          example: 5680
        create_time:
          type: integer
          format: int64
          description: æ³¨å†Œæ—¶é—´ï¼ˆUnixæ—¶é—´æˆ³ï¼‰
          example: 1759844400

    ImageUploadRequest:
      type: object
      required:
        - image
        - title
      properties:
        image:
          type: string
          format: binary
          description: å›¾ç‰‡æ–‡ä»¶ï¼ˆæ”¯æŒJPEG/PNG/WebPï¼Œæœ€å¤§5MBï¼‰
        title:
          type: string
          maxLength: 255
          description: æ¨æ–‡æ ‡é¢˜
          example: "ç¾ä¸½çš„é£æ™¯"
        description:
          type: string
          description: æ¨æ–‡é…æ–‡
          example: "ä»Šå¤©æ‹æ‘„çš„æ—¥è½"
        tags:
          type: string
          description: æ ‡ç­¾åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼Œæœ€å¤š5ä¸ªï¼‰
          example: "é£æ™¯,æ—¥è½,æ‘„å½±"

    ImageUpdateRequest:
      type: object
      required:
        - title
      properties:
        title:
          type: string
          maxLength: 255
          description: æ–°æ ‡é¢˜
          example: "æ›´æ–°åçš„æ ‡é¢˜"
        description:
          type: string
          description: æ–°é…æ–‡
          example: "æ›´æ–°åçš„é…æ–‡"

    ImageListResponse:
      allOf:
        - $ref: '#/components/schemas/SuccessResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                total:
                  type: integer
                  description: æ€»æ•°é‡
                  example: 100
                page:
                  type: integer
                  description: å½“å‰é¡µç 
                  example: 1
                page_size:
                  type: integer
                  description: æ¯é¡µæ•°é‡
                  example: 20
                images:
                  type: array
                  items:
                    $ref: '#/components/schemas/Image'

paths:
  /auth/register:
    post:
      tags:
        - è®¤è¯
      summary: ç”¨æˆ·æ³¨å†Œ
      description: æ³¨å†Œæ–°ç”¨æˆ·è´¦å·
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: æ³¨å†ŒæˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                usernameExists:
                  value:
                    success: false
                    message: "ç”¨æˆ·åå·²å­˜åœ¨"
                    data: null
                phoneExists:
                  value:
                    success: false
                    message: "æ‰‹æœºå·å·²è¢«æ³¨å†Œ"
                    data: null

  /auth/login:
    post:
      tags:
        - è®¤è¯
      summary: ç”¨æˆ·ç™»å½•
      description: ç”¨æˆ·ç™»å½•è·å–è®¿é—®ä»¤ç‰Œ
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: ç™»å½•æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: è®¤è¯å¤±è´¥
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                wrongPassword:
                  value:
                    success: false
                    message: "å¯†ç é”™è¯¯"
                    data: null
                userNotFound:
                  value:
                    success: false
                    message: "ç”¨æˆ·ä¸å­˜åœ¨"
                    data: null

  /auth/validate:
    post:
      tags:
        - è®¤è¯
      summary: ä»¤ç‰ŒéªŒè¯
      description: éªŒè¯JWTè®¿é—®ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
      operationId: validateToken
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  description: JWTè®¿é—®ä»¤ç‰Œ
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: ä»¤ç‰ŒéªŒè¯ç»“æœ
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "ä»¤ç‰Œæœ‰æ•ˆ"
                  data:
                    type: object
                    properties:
                      user_id:
                        type: integer
                        example: 1
                      username:
                        type: string
                        example: "zhangsan"

  /auth/refresh:
    post:
      tags:
        - è®¤è¯
      summary: ä»¤ç‰Œåˆ·æ–°
      description: ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œè·å–æ–°çš„è®¿é—®ä»¤ç‰Œ
      operationId: refreshToken
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refresh_token
              properties:
                refresh_token:
                  type: string
                  description: JWTåˆ·æ–°ä»¤ç‰Œ
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: ä»¤ç‰Œåˆ·æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          access_token:
                            type: string
                            example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                          refresh_token:
                            type: string
                            example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        '401':
          description: åˆ·æ–°ä»¤ç‰Œæ— æ•ˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/logout:
    post:
      tags:
        - è®¤è¯
      summary: ç”¨æˆ·ç™»å‡º
      description: ç”¨æˆ·ç™»å‡ºï¼ˆJWTä»¤ç‰Œè‡ªåŠ¨è¿‡æœŸï¼‰
      operationId: logout
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - access_token
              properties:
                access_token:
                  type: string
                  description: JWTè®¿é—®ä»¤ç‰Œ
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: ç™»å‡ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /auth/password:
    put:
      tags:
        - è®¤è¯
      summary: ä¿®æ”¹å¯†ç 
      description: ä¿®æ”¹ç”¨æˆ·å¯†ç 
      operationId: changePassword
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
                - old_password
                - new_password
              properties:
                user_id:
                  type: integer
                  description: ç”¨æˆ·ID
                  example: 1
                old_password:
                  type: string
                  format: password
                  description: æ—§å¯†ç 
                  example: "password123"
                new_password:
                  type: string
                  format: password
                  minLength: 6
                  maxLength: 100
                  description: æ–°å¯†ç ï¼ˆ6-100å­—ç¬¦ï¼‰
                  example: "newpassword456"
      responses:
        '200':
          description: å¯†ç ä¿®æ”¹æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æ—§å¯†ç ä¸æ­£ç¡®
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/profile:
    get:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
      description: è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„å®Œæ•´ä¸ªäººä¿¡æ¯
      operationId: getUserProfile
      security:
        - BearerAuth: []
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: æ›´æ–°ç”¨æˆ·ä¿¡æ¯
      description: æ›´æ–°å½“å‰ç™»å½•ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯
      operationId: updateUserProfile
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserProfileUpdateRequest'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/check-username:
    get:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: æ£€æŸ¥ç”¨æˆ·åå¯ç”¨æ€§
      description: æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²è¢«ä½¿ç”¨
      operationId: checkUsernameAvailability
      parameters:
        - name: username
          in: query
          required: true
          schema:
            type: string
            minLength: 3
            maxLength: 50
          description: è¦æ£€æŸ¥çš„ç”¨æˆ·å
          example: "newuser123"
      responses:
        '200':
          description: æ£€æŸ¥æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          available:
                            type: boolean
                            description: ç”¨æˆ·åæ˜¯å¦å¯ç”¨
                            example: true
                          username:
                            type: string
                            description: æ£€æŸ¥çš„ç”¨æˆ·å
                            example: "newuser123"
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/{user_id}:
    get:
      tags:
        - ç”¨æˆ·ç®¡ç†
      summary: è·å–ç”¨æˆ·å…¬å¼€ä¿¡æ¯
      description: è·å–æŒ‡å®šç”¨æˆ·çš„å…¬å¼€ä¸ªäººä¿¡æ¯ï¼ˆä¸åŒ…æ‹¬æ•æ„Ÿä¿¡æ¯ï¼‰
      operationId: getPublicUserProfile
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: ç”¨æˆ·ID
          example: 1
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PublicUserProfile'
        '404':
          description: ç”¨æˆ·ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts:
    post:
      tags:
        - å¸–å­ç®¡ç†
      summary: åˆ›å»ºå¸–å­
      description: |
        åˆ›å»ºå¤šå›¾ç‰‡å¸–å­ï¼ˆ1-9å¼ å›¾ç‰‡ï¼‰

        **æ³¨æ„**ï¼šä½¿ç”¨multipart/form-dataæ ¼å¼ä¸Šä¼ 
        - title: å¸–å­æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
        - description: å¸–å­æè¿°/é…æ–‡ï¼ˆå¯é€‰ï¼‰
        - imageFiles: å›¾ç‰‡æ–‡ä»¶ï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨æ­¤å­—æ®µä¸Šä¼ å¤šå¼ å›¾ç‰‡ï¼ˆ1-9å¼ ï¼‰
        - tags: æ ‡ç­¾ï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨æ­¤å­—æ®µæ·»åŠ å¤šä¸ªæ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
      operationId: createPost
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - title
                - imageFiles
              properties:
                title:
                  type: string
                  description: å¸–å­æ ‡é¢˜
                  example: "ç¾å¥½çš„ä¸€å¤©"
                description:
                  type: string
                  description: å¸–å­æè¿°/é…æ–‡
                  example: "ä»Šå¤©å¤©æ°”çœŸå¥½ï¼"
                imageFiles:
                  type: array
                  description: å›¾ç‰‡æ–‡ä»¶ï¼ˆ1-9å¼ ï¼‰
                  items:
                    type: string
                    format: binary
                  minItems: 1
                  maxItems: 9
                tags:
                  type: array
                  description: æ ‡ç­¾åˆ—è¡¨
                  items:
                    type: string
                  example: ["é£æ™¯", "æ—…è¡Œ"]
      responses:
        '201':
          description: å¸–å­åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          post:
                            $ref: '#/components/schemas/Post'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidImageCount:
                  value:
                    success: false
                    message: "å›¾ç‰‡æ•°é‡å¿…é¡»åœ¨1-9å¼ ä¹‹é—´"
                    data: null
                invalidFileType:
                  value:
                    success: false
                    message: "åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶"
                    data: null
                fileTooLarge:
                  value:
                    success: false
                    message: "å›¾ç‰‡æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB"
                    data: null
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    get:
      tags:
        - å¸–å­ç®¡ç†
      summary: è·å–Feedæµ
      description: è·å–æœ€æ–°å¸–å­åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
      operationId: getRecentPosts
      parameters:
        - name: page
          in: query
          description: é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          posts:
                            type: array
                            items:
                              $ref: '#/components/schemas/Post'
                          total:
                            type: integer
                            description: æ€»æ•°
                            example: 100
                          page:
                            type: integer
                            description: å½“å‰é¡µç 
                            example: 1
                          page_size:
                            type: integer
                            description: æ¯é¡µæ•°é‡
                            example: 20

  /posts/{post_id}:
    get:
      tags:
        - å¸–å­ç®¡ç†
      summary: è·å–å¸–å­è¯¦æƒ…
      description: æ ¹æ®å¸–å­IDè·å–å¸–å­è¯¦ç»†ä¿¡æ¯
      operationId: getPostDetail
      parameters:
        - name: post_id
          in: path
          required: true
          description: å¸–å­ID
          schema:
            type: string
            example: "POST_2025Q4_123456"
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          post:
                            $ref: '#/components/schemas/Post'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      tags:
        - å¸–å­ç®¡ç†
      summary: æ›´æ–°å¸–å­
      description: æ›´æ–°å¸–å­çš„æ ‡é¢˜ã€æè¿°æˆ–æ ‡ç­¾
      operationId: updatePost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          required: true
          description: å¸–å­ID
          schema:
            type: string
            example: "POST_2025Q4_123456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  description: æ–°æ ‡é¢˜
                  example: "æ›´æ–°åçš„æ ‡é¢˜"
                description:
                  type: string
                  description: æ–°æè¿°
                  example: "æ›´æ–°åçš„æè¿°"
                tags:
                  type: array
                  description: æ–°æ ‡ç­¾åˆ—è¡¨
                  items:
                    type: string
                  example: ["é£æ™¯", "æ—…è¡Œ", "ç¾é£Ÿ"]
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™ï¼ˆä¸æ˜¯å¸–å­ä½œè€…ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - å¸–å­ç®¡ç†
      summary: åˆ é™¤å¸–å­
      description: åˆ é™¤æŒ‡å®šçš„å¸–å­åŠå…¶æ‰€æœ‰å›¾ç‰‡
      operationId: deletePost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          required: true
          description: å¸–å­ID
          schema:
            type: string
            example: "POST_2025Q4_123456"
      responses:
        '200':
          description: åˆ é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™ï¼ˆä¸æ˜¯å¸–å­ä½œè€…ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users/{user_id}/posts:
    get:
      tags:
        - å¸–å­ç®¡ç†
      summary: è·å–ç”¨æˆ·å¸–å­åˆ—è¡¨
      description: è·å–æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰å¸–å­
      operationId: getUserPosts
      parameters:
        - name: user_id
          in: path
          required: true
          description: ç”¨æˆ·ID
          schema:
            type: integer
            example: 1
        - name: page
          in: query
          description: é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          posts:
                            type: array
                            items:
                              $ref: '#/components/schemas/Post'
                          total:
                            type: integer
                            description: æ€»æ•°
                            example: 50
                          page:
                            type: integer
                            description: å½“å‰é¡µç 
                            example: 1
                          page_size:
                            type: integer
                            description: æ¯é¡µæ•°é‡
                            example: 20

  /posts/{post_id}/images:
    post:
      tags:
        - å¸–å­ç®¡ç†
      summary: å‘å¸–å­æ·»åŠ å›¾ç‰‡
      description: å‘å·²å­˜åœ¨çš„å¸–å­æ·»åŠ æ–°å›¾ç‰‡ï¼ˆæœ€å¤š9å¼ ï¼‰
      operationId: addImageToPost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          required: true
          description: å¸–å­ID
          schema:
            type: string
            example: "POST_2025Q4_123456"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - imageFile
              properties:
                imageFile:
                  type: string
                  format: binary
                  description: å›¾ç‰‡æ–‡ä»¶
      responses:
        '201':
          description: å›¾ç‰‡æ·»åŠ æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          image:
                            $ref: '#/components/schemas/Image'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                tooManyImages:
                  value:
                    success: false
                    message: "å¸–å­å›¾ç‰‡æ•°é‡å·²è¾¾ä¸Šé™ï¼ˆ9å¼ ï¼‰"
                    data: null
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™ï¼ˆä¸æ˜¯å¸–å­ä½œè€…ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts/{post_id}/images/{image_id}:
    delete:
      tags:
        - å¸–å­ç®¡ç†
      summary: åˆ é™¤å¸–å­ä¸­çš„å›¾ç‰‡
      description: ä»å¸–å­ä¸­åˆ é™¤æŒ‡å®šçš„å›¾ç‰‡
      operationId: removeImageFromPost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          required: true
          description: å¸–å­ID
          schema:
            type: string
            example: "POST_2025Q4_123456"
        - name: image_id
          in: path
          required: true
          description: å›¾ç‰‡ID
          schema:
            type: string
            example: "IMG_2025Q4_123456"
      responses:
        '200':
          description: åˆ é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                lastImage:
                  value:
                    success: false
                    message: "å¸–å­è‡³å°‘éœ€è¦ä¿ç•™ä¸€å¼ å›¾ç‰‡"
                    data: null
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™ï¼ˆä¸æ˜¯å¸–å­ä½œè€…ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­æˆ–å›¾ç‰‡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts/{post_id}/images/order:
    put:
      tags:
        - å¸–å­ç®¡ç†
      summary: è°ƒæ•´å›¾ç‰‡é¡ºåº
      description: è°ƒæ•´å¸–å­ä¸­å›¾ç‰‡çš„æ˜¾ç¤ºé¡ºåº
      operationId: reorderImages
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          required: true
          description: å¸–å­ID
          schema:
            type: string
            example: "POST_2025Q4_123456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image_ids
              properties:
                image_ids:
                  type: array
                  description: å›¾ç‰‡IDåˆ—è¡¨ï¼ˆæŒ‰æ–°é¡ºåºæ’åˆ—ï¼‰
                  items:
                    type: string
                  example: ["IMG_2025Q4_123456", "IMG_2025Q4_789012", "IMG_2025Q4_345678"]
      responses:
        '200':
          description: è°ƒæ•´æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™ï¼ˆä¸æ˜¯å¸–å­ä½œè€…ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /images:
    post:
      tags:
        - å›¾ç‰‡ç®¡ç†
      summary: ä¸Šä¼ å›¾ç‰‡
      description: ç”¨æˆ·ä¸Šä¼ å›¾æ–‡æ¨æ–‡ï¼ˆå›¾ç‰‡ä¸ºä¸» + é…æ–‡ï¼‰
      operationId: uploadImage
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ImageUploadRequest'
      responses:
        '201':
          description: å›¾ç‰‡ä¸Šä¼ æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Image'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - å›¾ç‰‡ç®¡ç†
      summary: è·å–æœ€æ–°å›¾ç‰‡åˆ—è¡¨
      description: è·å–æœ€æ–°å‘å¸ƒçš„å›¾æ–‡æ¨æ–‡åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
      operationId: getRecentImages
      parameters:
        - name: page
          in: query
          description: é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡ï¼ˆæœ€å¤§100ï¼‰
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 20
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImageListResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /images/{id}:
    get:
      tags:
        - å›¾ç‰‡ç®¡ç†
      summary: è·å–å›¾ç‰‡è¯¦æƒ…
      description: è·å–æŒ‡å®šå›¾æ–‡æ¨æ–‡çš„è¯¦ç»†ä¿¡æ¯ï¼ˆä¼šå¢åŠ æµè§ˆæ•°ï¼‰
      operationId: getImageById
      parameters:
        - name: id
          in: path
          description: å›¾ç‰‡ä¸šåŠ¡é€»è¾‘IDï¼ˆimage_idï¼‰
          required: true
          schema:
            type: string
            example: "IMG_2025Q4_123456"
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Image'
        '404':
          description: å›¾ç‰‡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - å›¾ç‰‡ç®¡ç†
      summary: æ›´æ–°å›¾æ–‡é…æ–‡
      description: æ›´æ–°å›¾æ–‡æ¨æ–‡çš„æ ‡é¢˜å’Œé…æ–‡ï¼ˆåªæœ‰æ‰€æœ‰è€…å¯ä»¥ç¼–è¾‘ï¼‰
      operationId: updateImage
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: å›¾ç‰‡ä¸šåŠ¡é€»è¾‘IDï¼ˆimage_idï¼‰
          required: true
          schema:
            type: string
            example: "IMG_2025Q4_123456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImageUpdateRequest'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™æˆ–å›¾ç‰‡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - å›¾ç‰‡ç®¡ç†
      summary: åˆ é™¤å›¾ç‰‡
      description: åˆ é™¤å›¾æ–‡æ¨æ–‡ï¼ˆåªæœ‰æ‰€æœ‰è€…å¯ä»¥åˆ é™¤ï¼‰
      operationId: deleteImage
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: å›¾ç‰‡ä¸šåŠ¡é€»è¾‘IDï¼ˆimage_idï¼‰
          required: true
          schema:
            type: string
            example: "IMG_2025Q4_123456"
      responses:
        '200':
          description: åˆ é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: æ— æƒé™æˆ–å›¾ç‰‡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users/{id}/images:
    get:
      tags:
        - å›¾ç‰‡ç®¡ç†
      summary: è·å–ç”¨æˆ·å›¾ç‰‡åˆ—è¡¨
      description: è·å–æŒ‡å®šç”¨æˆ·å‘å¸ƒçš„å›¾æ–‡æ¨æ–‡åˆ—è¡¨
      operationId: getUserImages
      parameters:
        - name: id
          in: path
          description: ç”¨æˆ·ID
          required: true
          schema:
            type: integer
            example: 1
        - name: page
          in: query
          description: é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡ï¼ˆæœ€å¤§100ï¼‰
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 20
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImageListResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /health:
    get:
      tags:
        - ç³»ç»Ÿ
      summary: å¥åº·æ£€æŸ¥
      description: æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
      operationId: healthCheck
      responses:
        '200':
          description: æœåŠ¡æ­£å¸¸
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"
                  timestamp:
                    type: integer
                    format: int64
                    example: 1704067200

  /metrics:
    get:
      tags:
        - ç³»ç»Ÿ
      summary: ç³»ç»ŸæŒ‡æ ‡
      description: è·å–ç³»ç»Ÿè¿è¡ŒæŒ‡æ ‡
      operationId: getMetrics
      responses:
        '200':
          description: æŒ‡æ ‡è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  uptime:
                    type: integer
                    description: è¿è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
                    example: 3600
                  requests_total:
                    type: integer
                    description: æ€»è¯·æ±‚æ•°
                    example: 1234
                  database_connections:
                    type: integer
                    description: æ•°æ®åº“è¿æ¥æ•°
                    example: 10

  /version:
    get:
      tags:
        - ç³»ç»Ÿ
      summary: ç‰ˆæœ¬ä¿¡æ¯
      description: è·å–APIç‰ˆæœ¬ä¿¡æ¯
      operationId: getVersion
      responses:
        '200':
          description: ç‰ˆæœ¬ä¿¡æ¯è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                    example: "2.4.0"
                  service:
                    type: string
                    example: "Knot - Image Sharing Service"
                  timestamp:
                    type: integer
                    format: int64
                    example: 1704067200

  /posts/{post_id}/like:
    post:
      tags:
        - ç‚¹èµ
      summary: ç‚¹èµå¸–å­
      description: ä¸ºæŒ‡å®šå¸–å­ç‚¹èµ
      operationId: likePost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: ç‚¹èµæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LikeStatusResponse'
        '400':
          description: å·²ç»ç‚¹èµè¿‡è¯¥å¸–å­
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - ç‚¹èµ
      summary: å–æ¶ˆç‚¹èµ
      description: å–æ¶ˆå¯¹å¸–å­çš„ç‚¹èµ
      operationId: unlikePost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: å–æ¶ˆç‚¹èµæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LikeStatusResponse'
        '400':
          description: å°šæœªç‚¹èµè¯¥å¸–å­
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts/{post_id}/like/status:
    get:
      tags:
        - ç‚¹èµ
      summary: æŸ¥è¯¢ç‚¹èµçŠ¶æ€
      description: æŸ¥è¯¢å½“å‰ç”¨æˆ·å¯¹æŒ‡å®šå¸–å­çš„ç‚¹èµçŠ¶æ€
      operationId: getLikeStatus
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LikeStatusResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts/{post_id}/favorite:
    post:
      tags:
        - æ”¶è—
      summary: æ”¶è—å¸–å­
      description: æ”¶è—æŒ‡å®šå¸–å­
      operationId: favoritePost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: æ”¶è—æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoriteStatusResponse'
        '400':
          description: å·²ç»æ”¶è—è¿‡è¯¥å¸–å­
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - æ”¶è—
      summary: å–æ¶ˆæ”¶è—
      description: å–æ¶ˆæ”¶è—å¸–å­
      operationId: unfavoritePost
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: å–æ¶ˆæ”¶è—æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoriteStatusResponse'
        '400':
          description: å°šæœªæ”¶è—è¯¥å¸–å­
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts/{post_id}/favorite/status:
    get:
      tags:
        - æ”¶è—
      summary: æŸ¥è¯¢æ”¶è—çŠ¶æ€
      description: æŸ¥è¯¢å½“å‰ç”¨æˆ·å¯¹æŒ‡å®šå¸–å­çš„æ”¶è—çŠ¶æ€
      operationId: getFavoriteStatus
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoriteStatusResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /my/favorites:
    get:
      tags:
        - æ”¶è—
      summary: è·å–ç”¨æˆ·æ”¶è—åˆ—è¡¨
      description: è·å–å½“å‰ç”¨æˆ·çš„æ”¶è—å¸–å­åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
      operationId: getUserFavorites
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          description: é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡ï¼ˆæœ€å¤§100ï¼‰
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 20
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoriteListResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '400':
          description: å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /posts/{post_id}/share:
    post:
      tags:
        - åˆ†äº«
      summary: åˆ›å»ºå¸–å­åˆ†äº«é“¾æ¥
      description: ä¸ºå¸–å­åˆ›å»ºåˆ†äº«çŸ­é“¾æ¥ï¼Œæ”¯æŒiOS/Android/HarmonyOSä¸‰ç«¯Deep Link
      operationId: createShareLink
      security:
        - BearerAuth: []
      parameters:
        - name: post_id
          in: path
          description: å¸–å­ä¸šåŠ¡ID
          required: true
          schema:
            type: string
            example: "POST_2025Q4_ABC123"
      responses:
        '200':
          description: åˆ†äº«é“¾æ¥åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShareLinkResponse'
        '401':
          description: æœªæˆæƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: å¸–å­ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /share/{code}:
    get:
      tags:
        - åˆ†äº«
      summary: è§£æåˆ†äº«é“¾æ¥
      description: æ ¹æ®çŸ­é“¾æ¥ä»£ç è·å–å¸–å­ä¿¡æ¯ï¼ˆå…¬å¼€æ¥å£ï¼Œæ— éœ€è®¤è¯ï¼‰
      operationId: resolveShareLink
      parameters:
        - name: code
          in: path
          description: çŸ­é“¾æ¥ä»£ç 
          required: true
          schema:
            type: string
            example: "kHr7ZS9a"
      responses:
        '200':
          description: æŸ¥è¯¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SharePostResponse'
        '404':
          description: åˆ†äº«é“¾æ¥ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

