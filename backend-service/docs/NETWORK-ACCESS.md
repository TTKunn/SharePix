# ğŸŒ å±€åŸŸç½‘è®¿é—®é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•ä»å±€åŸŸç½‘å†…çš„å…¶ä»–è®¾å¤‡ï¼ˆå¦‚Windowså®¿ä¸»æœºï¼‰è®¿é—®è™šæ‹Ÿæœºä¸­è¿è¡Œçš„KnotæœåŠ¡ã€‚

## ğŸ” å½“å‰ç½‘ç»œé…ç½®

### è™šæ‹Ÿæœºä¿¡æ¯
- **IPåœ°å€**: `192.168.32.128`
- **ç½‘ç»œæ¥å£**: `ens33`
- **ç½‘ç»œæ¨¡å¼**: æ¡¥æ¥æ¨¡å¼ï¼ˆBridgedï¼‰æˆ–NATæ¨¡å¼
- **å­ç½‘**: `192.168.32.0/24`

### æœåŠ¡ç«¯å£
- **åç«¯APIæœåŠ¡**: `8080`
- **APIæ–‡æ¡£æœåŠ¡**: `8081`

## ğŸš€ å¿«é€Ÿè®¿é—®

### ä»Windowså®¿ä¸»æœºè®¿é—®

#### 1. è®¿é—®APIæ–‡æ¡£
```
http://192.168.32.128:8081/api-docs.html
```

#### 2. è®¿é—®åç«¯API
```
http://192.168.32.128:8080/api/v1/
```

#### 3. æµ‹è¯•è¿æ¥
åœ¨Windowså‘½ä»¤æç¤ºç¬¦æˆ–PowerShellä¸­ï¼š
```cmd
ping 192.168.32.128
```

å¦‚æœpingé€šï¼Œè¯´æ˜ç½‘ç»œè¿æ¥æ­£å¸¸ã€‚

## ğŸ”§ é…ç½®æ­¥éª¤

### æ­¥éª¤1ï¼šç¡®è®¤è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼

#### VMware Workstation
1. å³é”®è™šæ‹Ÿæœº â†’ è®¾ç½®
2. é€‰æ‹©"ç½‘ç»œé€‚é…å™¨"
3. ç¡®è®¤ç½‘ç»œè¿æ¥æ¨¡å¼ï¼š
   - **æ¡¥æ¥æ¨¡å¼ï¼ˆæ¨èï¼‰**: è™šæ‹Ÿæœºè·å¾—ä¸å®¿ä¸»æœºåŒç½‘æ®µçš„IP
   - **NATæ¨¡å¼**: éœ€è¦é…ç½®ç«¯å£è½¬å‘

#### VirtualBox
1. è®¾ç½® â†’ ç½‘ç»œ
2. ç½‘å¡1 â†’ è¿æ¥æ–¹å¼
3. é€‰æ‹©"æ¡¥æ¥ç½‘å¡"

### æ­¥éª¤2ï¼šæ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ

åœ¨è™šæ‹Ÿæœºä¸­æ‰§è¡Œï¼š
```bash
# æ£€æŸ¥åç«¯APIæœåŠ¡
netstat -tlnp | grep 8080

# æ£€æŸ¥APIæ–‡æ¡£æœåŠ¡
netstat -tlnp | grep 8081
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      12345/knot_image_sh
tcp        0      0 0.0.0.0:8081            0.0.0.0:*               LISTEN      12346/python3
```

**é‡è¦**: ç¡®ä¿æœåŠ¡ç›‘å¬åœ¨ `0.0.0.0` è€Œä¸æ˜¯ `127.0.0.1`

### æ­¥éª¤3ï¼šæ£€æŸ¥é˜²ç«å¢™ï¼ˆå¦‚æœéœ€è¦ï¼‰

#### æ£€æŸ¥UFWçŠ¶æ€
```bash
sudo ufw status
```

#### å¦‚æœUFWæ¿€æ´»ï¼Œå¼€æ”¾ç«¯å£
```bash
# å¼€æ”¾åç«¯APIç«¯å£
sudo ufw allow 8080/tcp

# å¼€æ”¾APIæ–‡æ¡£ç«¯å£
sudo ufw allow 8081/tcp

# é‡æ–°åŠ è½½é˜²ç«å¢™
sudo ufw reload
```

#### æ£€æŸ¥firewalldï¼ˆCentOS/RHELï¼‰
```bash
# æ£€æŸ¥çŠ¶æ€
sudo firewall-cmd --state

# å¼€æ”¾ç«¯å£
sudo firewall-cmd --permanent --add-port=8080/tcp
sudo firewall-cmd --permanent --add-port=8081/tcp
sudo firewall-cmd --reload
```

### æ­¥éª¤4ï¼šä»Windowsæµ‹è¯•è®¿é—®

#### æ–¹æ³•1ï¼šä½¿ç”¨æµè§ˆå™¨
ç›´æ¥è®¿é—®ï¼š
- APIæ–‡æ¡£: http://192.168.32.128:8081/api-docs.html
- åç«¯API: http://192.168.32.128:8080/health

#### æ–¹æ³•2ï¼šä½¿ç”¨curlï¼ˆWindows PowerShellï¼‰
```powershell
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://192.168.32.128:8080/health

# æµ‹è¯•APIæ–‡æ¡£
curl http://192.168.32.128:8081/api-docs.html
```

#### æ–¹æ³•3ï¼šä½¿ç”¨Postman
1. æ‰“å¼€Postman
2. åˆ›å»ºæ–°è¯·æ±‚
3. URL: `http://192.168.32.128:8080/api/v1/auth/login`
4. æ–¹æ³•: POST
5. Body: 
   ```json
   {
     "username": "testuser",
     "password": "Test123456"
   }
   ```
6. å‘é€è¯·æ±‚

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ— æ³•pingé€šè™šæ‹ŸæœºIP

**å¯èƒ½åŸå› **:
1. è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼ä¸æ­£ç¡®
2. Windowsé˜²ç«å¢™é˜»æ­¢ICMP
3. è™šæ‹Ÿæœºç½‘ç»œé€‚é…å™¨æœªå¯ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# åœ¨è™šæ‹Ÿæœºä¸­æ£€æŸ¥ç½‘ç»œæ¥å£
ip link show ens33

# å¦‚æœæ¥å£downï¼Œå¯ç”¨å®ƒ
sudo ip link set ens33 up

# é‡å¯ç½‘ç»œæœåŠ¡
sudo systemctl restart NetworkManager
```

### Q2: pingé€šä½†æ— æ³•è®¿é—®æœåŠ¡

**å¯èƒ½åŸå› **:
1. æœåŠ¡æœªå¯åŠ¨
2. æœåŠ¡ç›‘å¬åœ¨127.0.0.1è€Œä¸æ˜¯0.0.0.0
3. é˜²ç«å¢™é˜»æ­¢ç«¯å£

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦ç›‘å¬åœ¨0.0.0.0
netstat -tlnp | grep -E "8080|8081"

# å¦‚æœç›‘å¬åœ¨127.0.0.1ï¼Œéœ€è¦ä¿®æ”¹æœåŠ¡é…ç½®
# å¯¹äºAPIæ–‡æ¡£æœåŠ¡ï¼Œstart-api-docs.shå·²é…ç½®ä¸º0.0.0.0
# å¯¹äºåç«¯APIï¼Œæ£€æŸ¥config/config.jsonä¸­çš„hosté…ç½®
```

### Q3: æµè§ˆå™¨æ˜¾ç¤º"æ— æ³•è®¿é—®æ­¤ç½‘ç«™"

**å¯èƒ½åŸå› **:
1. IPåœ°å€é”™è¯¯
2. ç«¯å£å·é”™è¯¯
3. æœåŠ¡æœªè¿è¡Œ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# åœ¨è™šæ‹Ÿæœºä¸­ç¡®è®¤IPåœ°å€
ip addr show ens33 | grep inet

# ç¡®è®¤æœåŠ¡è¿è¡ŒçŠ¶æ€
ps aux | grep -E "knot_image_sharing|python3.*8081"
```

### Q4: NATæ¨¡å¼ä¸‹æ— æ³•è®¿é—®

**è§£å†³æ–¹æ¡ˆ**:
é…ç½®ç«¯å£è½¬å‘ï¼ˆVMwareç¤ºä¾‹ï¼‰ï¼š
1. ç¼–è¾‘ â†’ è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨
2. é€‰æ‹©NATç½‘ç»œ
3. NATè®¾ç½® â†’ ç«¯å£è½¬å‘
4. æ·»åŠ è§„åˆ™ï¼š
   - ä¸»æœºç«¯å£: 8080 â†’ è™šæ‹ŸæœºIP: 192.168.32.128:8080
   - ä¸»æœºç«¯å£: 8081 â†’ è™šæ‹ŸæœºIP: 192.168.32.128:8081

ç„¶åä»Windowsè®¿é—®ï¼š
- http://localhost:8080
- http://localhost:8081/api-docs.html

## ğŸ“± ç§»åŠ¨è®¾å¤‡è®¿é—®

å¦‚æœæ‚¨çš„æ‰‹æœºå’Œè™šæ‹Ÿæœºåœ¨åŒä¸€WiFiç½‘ç»œï¼š

1. ç¡®ä¿æ‰‹æœºè¿æ¥åˆ°ä¸è™šæ‹Ÿæœºç›¸åŒçš„WiFi
2. åœ¨æ‰‹æœºæµè§ˆå™¨ä¸­è®¿é—®ï¼š
   - http://192.168.32.128:8081/api-docs.html
   - http://192.168.32.128:8080/api/v1/

## ğŸ”’ å®‰å…¨å»ºè®®

### å¼€å‘ç¯å¢ƒ
- âœ… å¯ä»¥ä½¿ç”¨0.0.0.0ç›‘å¬æ‰€æœ‰æ¥å£
- âœ… å¯ä»¥å¼€æ”¾é˜²ç«å¢™ç«¯å£
- âš ï¸ æ³¨æ„ä¸è¦æš´éœ²åˆ°å…¬ç½‘

### ç”Ÿäº§ç¯å¢ƒ
- âŒ ä¸è¦ä½¿ç”¨0.0.0.0ç›‘å¬
- âœ… ä½¿ç”¨åå‘ä»£ç†ï¼ˆNginxï¼‰
- âœ… é…ç½®HTTPS
- âœ… é™åˆ¶è®¿é—®IPèŒƒå›´
- âœ… ä½¿ç”¨é˜²ç«å¢™è§„åˆ™

## ğŸ“ å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] è™šæ‹ŸæœºIPåœ°å€: `192.168.32.128`
- [ ] åç«¯APIæœåŠ¡è¿è¡Œä¸­ï¼ˆç«¯å£8080ï¼‰
- [ ] APIæ–‡æ¡£æœåŠ¡è¿è¡Œä¸­ï¼ˆç«¯å£8081ï¼‰
- [ ] æœåŠ¡ç›‘å¬åœ¨0.0.0.0
- [ ] é˜²ç«å¢™å·²å¼€æ”¾ç«¯å£ï¼ˆå¦‚æœå¯ç”¨ï¼‰
- [ ] Windowså¯ä»¥pingé€šè™šæ‹Ÿæœº
- [ ] æµè§ˆå™¨å¯ä»¥è®¿é—®APIæ–‡æ¡£

## ğŸ› ï¸ è‡ªåŠ¨åŒ–è„šæœ¬

åˆ›å»ºä¸€ä¸ªå¿«é€Ÿæ£€æŸ¥è„šæœ¬ï¼š

```bash
#!/bin/bash
# æ–‡ä»¶: check-network-access.sh

echo "=== Knot ç½‘ç»œè®¿é—®æ£€æŸ¥ ==="
echo ""

# 1. æ£€æŸ¥IPåœ°å€
echo "1. è™šæ‹ŸæœºIPåœ°å€:"
ip addr show ens33 | grep "inet " | awk '{print $2}'
echo ""

# 2. æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "2. æœåŠ¡è¿è¡ŒçŠ¶æ€:"
echo "åç«¯API (8080):"
netstat -tlnp 2>/dev/null | grep 8080 || echo "  æœªè¿è¡Œ"
echo "APIæ–‡æ¡£ (8081):"
netstat -tlnp 2>/dev/null | grep 8081 || echo "  æœªè¿è¡Œ"
echo ""

# 3. æ£€æŸ¥é˜²ç«å¢™
echo "3. é˜²ç«å¢™çŠ¶æ€:"
if command -v ufw &> /dev/null; then
    sudo ufw status | grep -E "8080|8081|Status"
else
    echo "  UFWæœªå®‰è£…"
fi
echo ""

# 4. è®¿é—®åœ°å€
echo "4. è®¿é—®åœ°å€:"
VM_IP=$(ip addr show ens33 | grep "inet " | awk '{print $2}' | cut -d'/' -f1)
echo "  APIæ–‡æ¡£: http://$VM_IP:8081/api-docs.html"
echo "  åç«¯API: http://$VM_IP:8080/api/v1/"
echo ""

echo "=== æ£€æŸ¥å®Œæˆ ==="
```

ä¿å­˜å¹¶è¿è¡Œï¼š
```bash
chmod +x check-network-access.sh
./check-network-access.sh
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœä»ç„¶æ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥ï¼š
1. è™šæ‹Ÿæœºç½‘ç»œé…ç½®
2. Windowsé˜²ç«å¢™è®¾ç½®
3. è·¯ç”±å™¨é…ç½®ï¼ˆå¦‚æœè·¨å­ç½‘ï¼‰

---

**æœ€åæ›´æ–°**: 2025-10-08  
**é€‚ç”¨ç‰ˆæœ¬**: Knot v1.2.0

